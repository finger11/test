<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>세입자보증금 계산기</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    table, th, td {
      border: 1px solid gray;
      border-collapse: collapse;
      padding: 5px;
      text-align: center;
    }
    th { background-color: #f0f0f0; }
    td input, td select { width: 100%; box-sizing: border-box; text-align: right; }
    button { margin: 5px; }
    .blue { color: blue; font-weight: bold; }
    .red { color: red; font-weight: bold; }
  </style>
</head>
<body>

<h2>세입자보증금 계산기</h2>

<h3>부동산소재지구분</h3>
<select id="locationSelect"></select>

<div id="smallTenantInfo" style="margin: 10px 0; font-weight: bold;"></div>

<h3>근저당에 관한 내용</h3>
<table id="mortgageTable">
  <thead>
    <tr>
      <th>근저당권자명</th>
      <th>근저당설정일자</th>
      <th>근저당금액</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<button onclick="addRow('mortgageTable', ['text', 'date', 'currency-mortgage'])">근저당 행 추가</button>
<button onclick="removeRow('mortgageTable')">근저당 행 삭제</button>

<h3>가압류에 관한 내용</h3>
<table id="seizureTable">
  <thead>
    <tr>
      <th>가압류권자명</th>
      <th>가압류접수일자</th>
      <th>가압류금액</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<button onclick="addRow('seizureTable', ['text', 'date', 'currency-seizure'])">가압류 행 추가</button>
<button onclick="removeRow('seizureTable')">가압류 행 삭제</button>

<h3>세입자에 관한 내용</h3>
<table id="tenantTable">
  <thead>
    <tr>
      <th>호실명</th>
      <th>임차인명</th>
      <th>확정일자</th>
      <th>전입신고일자</th>
      <th>점유일자</th>
      <th>보증금</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<button onclick="addRow('tenantTable', ['text', 'text', 'date', 'date', 'date', 'currency-deposit'])">세입자 행 추가</button>
<button onclick="removeRow('tenantTable')">세입자 행 삭제</button>

<h3>예상낙찰금액</h3>
<input type="text" id="auctionPrice" placeholder="예: 600,000,000" oninput="this.value = formatNumberInput(this.value)">

<br><br>
<button onclick="calculate()">계산하기</button>

<h3>최우선변제금 배당결과</h3>
<div id="priorityCompensationArea"></div>

<h3>배당결과</h3>
<div id="resultArea"></div>

<script src="priority_table_v11.js"></script>
<script>
// 이하 스크립트는 동일, calculate 함수의 기준 찾는 부분 수정
function calculate() {
  const auctionPrice = parseNumber(document.getElementById('auctionPrice').value);
  const location = document.getElementById('locationSelect').value;
  const mortgageDateInput = document.querySelector('#mortgageTable tbody input[type="date"]');
  const mortgageDate = mortgageDateInput ? mortgageDateInput.value : '';

  if (!location || !mortgageDate) {
    alert('부동산소재지구분과 근저당설정일자를 모두 입력해 주세요.');
    return;
  }

  const 설정일 = new Date(mortgageDate);

  let 기준 = 기준표.find(item => {
    const 시작 = new Date(item.시작);
    const 종료 = item.종료 ? new Date(item.종료) : new Date('9999-12-31');
    return item.지역 === location && 시작 <= 설정일 && 설정일 <= 종료;
  });

  if (!기준) {
    기준 = 기준표.find(item => {
      const 시작 = new Date(item.시작);
      const 종료 = item.종료 ? new Date(item.종료) : new Date('9999-12-31');
      return item.지역 === '기타지역' && 시작 <= 설정일 && 설정일 <= 종료;
    });
  }

  if (!기준) {
    alert('적용 가능한 기준이 없습니다. 부동산소재지구분과 근저당설정일자를 다시 확인하세요.');
    return;
  }

  const 소액임차인기준 = 기준 ? parseNumber(기준.보증금상한) : null;

  // 이하 생략 (기존 코드 유지)
}
</script>

</body>
</html>
